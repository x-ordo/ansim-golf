# 안심골프 상세 기획서 (Service Specification)

## 1. 정보 구조도 (IA - Information Architecture)

```
[Main]
├── Header (Global Navigation)
│   ├── View Mode Toggle (실시간 타임 / 안심 추천 / 파트너 SaaS)
│   └── User Menu (로그인 / 마이페이지)
│
├── [View: Board/Pro] (사용자 메인)
│   ├── Date Selector (날짜 선택)
│   ├── Region Filter (지역 필터)
│   ├── Search Bar (골프장 검색)
│   ├── Content Area (티타임 리스트)
│   │   ├── Board List Item (리스트형)
│   │   └── Booking Card (카드형)
│   └── Quick Actions
│       ├── AI Chat Drawer (AI 상담)
│       └── Filter/Sort
│
├── [View: SaaS] (매니저 메인)
│   ├── Dashboard (운영 요약)
│   ├── Inventory (티타임 관리 - 등록/수정/삭제)
│   ├── Members (회원 관리)
│   ├── Bookings (예약 현황)
│   └── Kanban (업무 관리)
│
└── [Common Drawers/Modals]
    ├── Login/Signup
    ├── Payment (에스크로 결제)
    ├── ChatRoom (매니저 1:1 채팅)
    └── Legal (약관/정책)
```

## 2. 주요 프로세스 및 상세 로직

### 2.1. 티타임 예약 및 결제 프로세스
1.  **검색/탐색**:
    - 사용자는 날짜, 지역 필터를 통해 티타임을 탐색.
    - `BoardListItem` 또는 `BookingCard` 클릭 시 상세 정보(채팅방) 진입.
2.  **상담 및 조율 (Chat)**:
    - 매니저(또는 봇)와 1:1 채팅방 개설.
    - 티타임 세부 조건 확인 (인원, 캐디 여부 등).
3.  **에스크로 결제 요청**:
    - 사용자가 예약 의사 표시 시, 시스템 내 '안심결제 요청' 버튼 활성화.
    - `PaymentDrawer` 오픈.
4.  **결제 수행**:
    - Toss Payments 연동.
    - 결제 금액은 플랫폼의 에스크로 계좌로 예치됨.
    - 결제 완료 시 상태 변경: `AVAILABLE` -> `CONFIRMED`.
5.  **예약 확정 및 라운딩**:
    - 예약 확정 알림톡 발송 (매니저 -> 사용자).
    - 라운딩 정상 종료 확인 후 정산 진행.

### 2.2. 매니저 티타임 등록 프로세스 (SaaS)
1.  **텍스트 파싱 등록**:
    - 매니저가 카카오톡 등으로 받은 텍스트 덩어리를 `ManagerSaaS` 입력창에 붙여넣기.
    - **Logic**: 정규표현식(Regex) 또는 LLM을 사용하여 날짜, 시간, 골프장명, 금액, 코스 정보를 자동 추출.
    - 추출된 데이터를 그리드(Table) 형태로 미리보기 제공.
2.  **검수 및 등록**:
    - 매니저가 파싱 결과 확인 후 수정/확정.
    - '등록' 버튼 클릭 시 DB 저장 및 사용자 뷰(Board/Pro)에 즉시 노출.
3.  **상태 관리**:
    - 판매 중 / 예약 요청 / 입금 대기 / 확정 / 취소 등 상태 값 변경.

### 2.3. AI 챗봇 인터랙션
1.  **진입**: 화면 하단 또는 플로팅 버튼을 통해 `AIChatDrawer` 호출.
2.  **질의**: 사용자가 자연어로 질문 (예: "이번 주말 수도권 20만원 이하 찾아줘").
3.  **처리**:
    - `geminiService` 호출.
    - 프롬프트 엔지니어링을 통해 사용자 의도(Intent) 파악 (검색, 추천, 규정 문의 등).
    - DB 내 `TeeTime` 데이터를 검색하여 적합한 결과 추천.
4.  **응답**: 추천 티타임 카드와 함께 답변 출력. 카드 클릭 시 해당 예약 페이지로 이동.

## 3. 상세 기능 명세

### 3.1. 결제 모듈 (PaymentDrawer)
- **Props**: `teeTime` (대상 티타임 정보), `onSuccess` (콜백).
- **UI**:
    - 상단: 에스크로 안심 결제 뱃지 및 신뢰 문구.
    - 중단: 상품 정보(골프장, 시간) 및 금액, 환불 규정 요약.
    - 하단: 결제 수단 선택 및 '결제하기' 버튼.
- **예외 처리**: 결제 실패, 타임아웃, 중복 결제 시도 차단.

### 3.2. SaaS 대시보드 (GMSAdmin)
- **Stats Cards**: 예약률, 예상 매출, 덤핑 활성화 건수 등.
- **Dumping Engine UI**:
    - 잔여 시간이 임박한(예: 24시간 이내) 타임 자동 감지.
    - 기존 가격 대비 할인율 적용 제안.
    - 매니저 승인 시 즉시 가격 인하 반영 및 '특가' 뱃지 부착.

### 3.3. 칸반 보드 (NotionKanban)
- **목적**: 매니저의 내부 업무(전화 응대, 입금 확인, 클레임 처리 등) 시각화.
- **상태**: TODO -> IN_PROGRESS -> REVIEW -> DONE.
- **Drag & Drop**: 상태 간 카드 이동 UI 제공.

## 4. 데이터 정책
- **회원 정보**: 최소한의 정보(이름, 연락처)만 수집, 인증 기반 가입.
- **위약금**: 라운딩 3일 전 100% 환불, 당일 취소 불가 등 표준 약관 적용 (매니저별 커스텀 가능).
- **데이터 보존**: 거래 기록 5년 보관 (전자상거래법 준수).
